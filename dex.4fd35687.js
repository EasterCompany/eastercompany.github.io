(()=>{function Y(){console.log("Applying base styles dynamically (e.g., for background animation or theme toggles).")}function X(n=!1){let r=`
        <div class="nav-left">
            <img src="/static/meta/favicon.svg" alt="Easter Company Favicon" class="navbar-favicon">
            <i class='bx bx-microphone' id="navbar-microphone"></i>
        </div>
        <div class="nav-right">
            ${n?`
            <i id="message-icon" class='bx bxs-message-dots'></i>
            <i id="user-icon" class='bx bx-user'></i>
            <i id="settings-icon" class='bx bx-cog'></i>
        `:`
            <button id="login-btn" class="login-btn">LOGIN</button>
        `}
        </div>
    `,h=document.createElement("nav");h.innerHTML=r,document.body.prepend(h)}function Q(){let n=`
        <div class="socials-section">
            <a href="https://facebook.com/eastercompany" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><i class="bx bxl-facebook-square"></i></a>
            <a href="https://linkedin.com/company/72223947" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="bx bxl-linkedin"></i></a>
            <a href="https://instagram.com/eastercompany" aria-label="Instagram" target="_blank" rel="noopener noreferrer"><i class="bx bxl-instagram-alt"></i></a>
            <a href="https://x.com/eastercompany" aria-label="X" target="_blank" rel="noopener noreferrer"><i class="bx bxl-twitter"></i></a>
            <a href="https://github.com/eastercompany" aria-label="GitHub" target="_blank" rel="noopener noreferrer"><i class="bx bxl-github"></i></a>
            <a href="https://youtube.com/@eastercompany" aria-label="YouTube" target="_blank" rel="noopener noreferrer"><i class="bx bxl-youtube"></i></a>
        </div>
    `,l=document.createElement("footer");l.innerHTML=n,document.body.appendChild(l)}var Z="easter_user_email";function ee(){return localStorage.getItem(Z)!==null}function te(n){if(!n||!n.includes("@"))throw new Error("Invalid email address");if(!n.trim().toLowerCase().endsWith("@easter.company"))throw new Error("Access denied. Please check your credentials.");localStorage.setItem(Z,n.trim())}var ae="easter_theme",H={AUTO:"auto",DEFAULT:"default",ANIMATED:"animated"};function oe(){return localStorage.getItem(ae)||H.AUTO}function re(){let n=window.innerWidth,l=window.innerHeight,r=window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width;return n>1920&&l>1080?H.ANIMATED:(n===1920&&l===1080&&r||n<=1920||l<=1080,H.DEFAULT)}function ne(n,l=!1){let r=document.body,h=n===H.AUTO?re():n;if(l||(r.classList.add("theme-transitioning"),setTimeout(()=>{r.classList.remove("theme-transitioning")},300)),Object.values(H).forEach(f=>{r.classList.remove(`theme-${f}`)}),r.classList.add(`theme-${n}`),h===H.ANIMATED){if(!document.querySelector(".background")){let f=document.createElement("div");f.className="background",document.body.prepend(f)}}else{let f=document.querySelector(".background");f&&(l?f.remove():(f.style.animation="fadeOutBackground 0.4s ease forwards",setTimeout(()=>{f.remove()},400)))}}function se(){let n=oe();if(ne(n,!0),n===H.AUTO){let l;window.addEventListener("resize",()=>{clearTimeout(l),l=setTimeout(()=>{ne(H.AUTO)},300)})}}function W(n,l,r=null){let f={config:"bx-cog",error:"bx-error-circle",empty:"bx-info-circle",offline:"bx-wifi-off"}[n]||"bx-info-circle",g=r?`<p class="placeholder-action">${r}</p>`:"";return`
        <div class="tab-placeholder">
            <i class='bx ${f} placeholder-icon'></i>
            <p class="placeholder-message">${l}</p>
            ${g}
        </div>
    `}async function P(){let n=document.getElementById("logs-container");if(!n)return!1;n.classList.remove("placeholder-active");let l=localStorage.getItem("service_map");if(!l)return n.classList.add("placeholder-active"),n.innerHTML=W("config","No service map configured.","Please upload your service-map.json in Settings to enable log monitoring."),!1;let r;try{r=JSON.parse(l)}catch(b){return console.error("Error parsing service_map from localStorage:",b),n.classList.add("placeholder-active"),n.innerHTML=W("error","Invalid service map data.","Please re-upload a valid service-map.json file in Settings."),!1}let h=null;if(r&&typeof r.services=="object"){let b=["cs","be","th"];for(let $ of b)if(Array.isArray(r.services[$])){let T=r.services[$].find(w=>w.short_name==="event"||w.id==="event"||w.id==="dex-event-service");if(T){h=T;break}}}if(!h)return n.classList.add("placeholder-active"),n.innerHTML=W("error","Event service not found in service map.","Please ensure dex-event-service is configured in your service-map.json."),!1;let g=`http://${h.domain==="0.0.0.0"?"localhost":h.domain}:${h.port}/logs`;try{let b=await fetch(g);if(!b.ok)return n.classList.add("placeholder-active"),n.innerHTML=W("offline","Event service is offline.","Please ensure the event service is running."),!1;let $=await b.json();if(!$||$.length===0)return n.classList.add("placeholder-active"),n.innerHTML=W("empty","No logs found.","Service logs will appear here when available."),!1;let T=["local-ollama-0","local-cache-0","cloud-cache-0","cloud-cache-1"],w=$.filter(y=>!T.includes(y.id));w.forEach(y=>{y.logs.reverse()}),w.reverse();let R=w.map(y=>{let U=y.logs.join(`
`);return`
                <div class="log-report">
                    <div class="log-report-header">
                        <h3>${y.id}</h3>
                        <button class="copy-logs-btn" data-logs="${escape(U)}">
                            <i class="bx bx-copy"></i>
                        </button>
                    </div>
                    <pre class="log-content">${U}</pre>
                </div>
            `}).join("");return n.innerHTML=R,document.querySelectorAll(".copy-logs-btn").forEach(y=>{y.addEventListener("click",()=>{let U=unescape(y.dataset.logs);navigator.clipboard.writeText(U).then(()=>{let A=y.querySelector("i");A.classList.remove("bx-copy"),A.classList.add("bx-check"),setTimeout(()=>{A.classList.remove("bx-check"),A.classList.add("bx-copy")},2e3)})})}),!0}catch(b){return console.error("Error fetching logs:",b),n.classList.add("placeholder-active"),n.innerHTML=W("offline","Failed to load logs.","The event service may be offline, unreachable, or blocked by a browser extension (e.g., ad blocker)."),!1}}function ie(){console.log("Welcome to Easter Company."),se(),Y();let n=ee();X(n),Q();let l=document.querySelector("footer"),r=null;function h(){r=null,l?.classList.remove("hide"),document.querySelectorAll(".nav-right i").forEach(t=>t.classList.remove("active","inactive"))}function f(t,a=null){let i=r&&r.id===t.id;r&&r.close(!i),i?r=null:setTimeout(()=>{t.open(),r=t,document.querySelectorAll(".nav-right i").forEach(v=>{let p=v===a;v.classList.toggle("active",p),v.classList.toggle("inactive",!p&&a)}),l?.classList.add("hide")},r?220:0)}function g(t,a,i=null){let p={config:"bx-cog",error:"bx-error-circle",empty:"bx-info-circle",offline:"bx-wifi-off"}[t]||"bx-info-circle",m=i?`<p class="placeholder-action">${i}</p>`:"";return`<div class="tab-placeholder"><i class='bx ${p} placeholder-icon'></i><p class="placeholder-message">${a}</p>${m}</div>`}let b=null,$=null,T=null,w=null,R=()=>localStorage.getItem("service_map")?'<div id="services-widgets" class="system-monitor-widgets"><p>Loading services...</p></div>':g("config","No service map configured.","Upload service-map.json in Settings."),y=()=>localStorage.getItem("service_map")?'<div id="models-widgets" class="system-monitor-widgets"><p>Loading models...</p></div>':g("config","No service map configured.","Upload service-map.json in Settings."),U=()=>'<div id="events-timeline" class="events-timeline"><p>Loading events...</p></div>';async function A(){if(!localStorage.getItem("service_map"))return null;try{let a=(JSON.parse(localStorage.getItem("service_map")).services?.cs||[]).find(m=>m.id==="dex-event-service");if(!a)return null;let v=`http://${a.domain==="0.0.0.0"?"localhost":a.domain}:${a.port}/system_monitor_metrics`,p=await fetch(v);if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);return await p.json()}catch(t){return console.error("Error fetching system data:",t),null}}async function z(){let t=document.getElementById("services-widgets");if(!t)return;let a=await A();if(!a||!a.services){t.innerHTML=g("offline","Failed to load system metrics.","The event service may be offline or unreachable.");return}b=Date.now(),E(4,b);let i=a.services||[];Array.from(t.children).forEach(e=>{e.classList.contains("service-widget")||e.remove()});function v(e){return!e||e==="N/A"||e==="unknown"||e.trim()===""?"-":e}function p(e){if(!e||e==="N/A"||e==="unknown")return"-";let s=e.match(/^(\d+\.\d+\.\d+)/);return s?s[0]:e.split(".").slice(0,3).join(".")||"-"}function m(e){return!e||e.length<=28?e:e.substring(0,28)+"..."}function x(e){if(!e||!e.includes("%"))return"#666";let s=parseFloat(e);return s<30?"#00ff00":s<60?"#88ff00":s<80?"#ffaa00":"#ff0000"}function u(e){if(!e||e==="N/A"||e==="unknown")return"-";let s=e.match(/(?:(\d+)d)?(?:(\d+)h)?(?:(\d+)m)?(?:([\d.]+)s)?/);if(!s)return"-";let c=parseInt(s[1])||0,o=parseInt(s[2])||0,d=parseInt(s[3])||0,M=parseFloat(s[4])||0,S=c*86400+o*3600+d*60+M,D=Math.floor(S/86400);if(D>0)return`${D}d`;let k=Math.floor(S/3600);if(k>0)return`${k}h`;let N=Math.floor(S/60);return N>0?`${N}m`:`${Math.floor(S)}s`}function L(e){let s=e.status==="online",c=s?"service-widget-online":"service-widget-offline",o=s?"bx-check-circle":"bx-x-circle",d=s?"OK":"BAD",M=e.version?p(e.version.str):"-",S=v(e.cpu),D=v(e.memory),k=x(S),N=x(D),B=u(e.uptime),I="";return s?I=`<div class="service-widget-info"><span class="info-label">Version:</span><span class="info-value metric-version-monospace">${M}</span></div><div class="service-widget-footer"><div class="service-widget-item"><i class="bx bx-time-five"></i><span>${B}</span></div><div class="service-widget-item"><i class="bx bxs-microchip" style="color: ${k};"></i><span style="color: ${k};">${S}</span></div><div class="service-widget-item"><i class="bx bxs-chip" style="color: ${N};"></i><span style="color: ${N};">${D}</span></div></div>`:I='<div class="service-widget-footer offline"><span>OFFLINE</span></div>',`<div class="service-widget ${c}" data-service-id="${e.id}"><div class="service-widget-header"><i class="bx ${o}"></i><h3>${e.short_name||e.id}</h3><span class="service-widget-status">${d}</span></div><div class="service-widget-body"><div class="service-widget-info"><span class="info-label">Address:</span><span class="info-value">${m(e.domain&&e.port?`${e.domain}:${e.port}`:"")}</span></div>${I}</div></div>`}let C=new Map(Array.from(t.querySelectorAll(".service-widget")).map(e=>[e.dataset.serviceId,e])),_=new Set(i.map(e=>e.id));for(let[e,s]of C)_.has(e)||s.remove();i.forEach(e=>{let s=L(e),c=C.get(e.id);c?c.outerHTML!==s&&(c.outerHTML=s):t.insertAdjacentHTML("beforeend",s)})}async function G(){let t=document.getElementById("models-widgets");if(!t)return;let a=await A();if(!a){t.innerHTML=g("offline","Failed to load model status.");return}w=Date.now(),E(3,w);let i=a.models||[],v=a.whisper;Array.from(t.children).forEach(u=>{u.classList.contains("service-widget")||u.remove()});function p(u){let L=u.status==="Ready";return`
                <div class="service-widget ${L?"service-widget-online":"service-widget-offline"}" data-whisper-widget>
                    <div class="service-widget-header">
                        <i class="bx bxs-microphone-alt"></i>
                        <h3>Whisper</h3>
                        <span class="service-widget-status">${L?"READY":"NOT FOUND"}</span>
                    </div>
                    <div class="service-widget-body">
                        <div class="service-widget-info">
                            <span class="info-label">Status:</span>
                            <span class="info-value">${u.status}</span>
                        </div>
                        <div class="service-widget-info">
                            <span class="info-label">Model:</span>
                            <span class="info-value">large-v3-turbo</span>
                        </div>
                    </div>
                </div>`}function m(u){let L=u.status==="Downloaded",C=L?"service-widget-online":"service-widget-offline",_=L?"OK":"MISSING",e=L&&u.size>0?`${(u.size/1e9).toFixed(2)} GB`:"-",s=u.name;return u.type==="custom"&&s.endsWith(":latest")&&(s=s.replace(":latest","")),`<div class="service-widget ${C}" data-model-name="${u.name}"><div class="service-widget-header"><i class="bx ${L?"bx-check-circle":"bx-x-circle"}"></i><h3>${s}</h3><span class="service-widget-status">${_}</span></div><div class="service-widget-body"><div class="service-widget-info"><span class="info-label">Type:</span><span class="info-value">${u.type}</span></div><div class="service-widget-info"><span class="info-label">Size:</span><span class="info-value">${e}</span></div></div></div>`}let x="";if(v&&(x+=p(v)),x+=i.map(m).join(""),!x){t.innerHTML=g("empty","No models found.");return}t.innerHTML!==x&&(t.innerHTML=x)}async function J(){let t=document.getElementById("events-timeline");if(!t)return;let a=localStorage.getItem("service_map");if(!a){t.innerHTML=g("config","No service map configured.","Upload service-map.json in Settings.");return}let i=null;try{i=(JSON.parse(a).services?.cs||[]).find(x=>x.id==="dex-event-service")}catch{t.innerHTML=g("error","Invalid service map data.");return}if(!i){t.innerHTML=g("error","Event service not found in service map.");return}let p=`http://${i.domain==="0.0.0.0"?"localhost":i.domain}:${i.port}/events?ml=50&format=json`;try{let m=await fetch(p);if(!m.ok)throw new Error("Service is offline or unreachable.");let u=(await m.json()).events||[];if(t.querySelector(".tab-placeholder")&&(t.innerHTML=""),u.length===0&&t.children.length===0){t.innerHTML=g("empty","No events found.");return}let L=c=>{let o=c.event;if(typeof o=="string")try{o=JSON.parse(o)}catch{return null}let d=o.type,M=d==="engagement.decision",S=M?"event-border-blue":"event-border-grey",D=M?"cursor-pointer":"",k=new Date(c.timestamp*1e3),N=k.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit",second:"2-digit"}),B=k.toLocaleDateString(navigator.language,{month:"short",day:"numeric"}),I=`${d}`;d==="message_received"||d==="messaging.user.sent_message"?I=`${o.user_name||o.user} in ${o.channel_name||o.channel}: ${o.content||o.message}`:d==="engagement.decision"?I=`Engagement Decision: ${o.decision} (${o.reason})`:d==="bot_response"?I=`Bot Responded: ${o.response}`:(d==="voice_transcribed"||d==="messaging.user.transcribed")&&(I=`${o.user_name||o.user_id} said: ${o.transcription}`);let K="";M&&(K=`
                        <div class="event-details" style="display: none;">
                            <div class="event-details-header">
                                <h4>Event Details</h4>
                                <i class="bx bx-x close-details-btn"></i>
                            </div>
                            <div class="event-detail-row">
                                <span class="detail-label">Engagement Model:</span>
                                <span class="detail-value">${o.engagement_model||"N/A"}</span>
                            </div>
                            <div class="event-detail-row">
                                <span class="detail-label">Response Model:</span>
                                <span class="detail-value">${o.response_model||"N/A"}</span>
                            </div>
                            <div class="event-detail-block">
                                <span class="detail-label">Context History:</span>
                                <pre class="detail-pre">${o.context_history||"None"}</pre>
                            </div>
                            <div class="event-detail-block">
                                <span class="detail-label">Raw Engagement Output:</span>
                                <pre class="detail-pre">${o.engagement_raw||"None"}</pre>
                            </div>
                            <div class="event-detail-block">
                                <span class="detail-label">Raw Response Output:</span>
                                <pre class="detail-pre">${o.response_raw||"None"}</pre>
                            </div>
                        </div>
                    `);let O=document.createElement("div");if(O.className=`event-item ${S} ${D}`,O.dataset.eventId=c.id,O.onclick=function(q){if(!M)return;this.classList.toggle("expanded");let j=this.querySelector(".event-details");j&&(j.style.display=j.style.display==="none"?"block":"none")},O.innerHTML=`
                    <div class="event-time">
                        <span class="event-time-main">${N}</span>
                        <span class="event-date">${B}</span>
                    </div>
                    <div class="event-content">
                        <div class="event-service">${c.service}</div>
                        <div class="event-message">${I}</div>
                        ${K}
                    </div>
                `,M){let q=O.querySelector(".close-details-btn");q&&q.addEventListener("click",j=>{j.stopPropagation();let F=j.target.closest(".event-item");if(F){F.classList.remove("expanded");let V=F.querySelector(".event-details");V&&(V.style.display="none")}})}return O},C=Array.from(t.children),_=new Map(C.map(c=>[c.dataset.eventId,c])),e=new Set(u.map(c=>c.id));C.forEach(c=>{c.dataset.eventId&&!e.has(c.dataset.eventId)&&c.remove()});let s=null;u.forEach((c,o)=>{let d=_.get(c.id);!d&&(d=L(c),!d)||(o===0?t.firstElementChild!==d&&t.prepend(d):s&&s.nextElementSibling!==d&&s.after(d),s=d)}),$=Date.now(),E(1,$)}catch(m){console.error("Error fetching events:",m),t.children.length===0&&(t.innerHTML=g("offline","Failed to load events.","The event service may be offline or unreachable."))}}function E(t,a){let i=document.querySelector(`.tab[data-tab-index="${t}"] .tab-subtitle`);if(!i)return;if(!a){i.textContent="Last updated: never";return}let p=(Date.now()-a)/1e3,m;if(p<30)m=`${Math.floor(p)}s ago`;else{i.textContent="Last updated: never";return}i.textContent=`Last updated: ${m}`}async function ce(){await Promise.all([z(),G(),J(),P().then(v=>{v&&(T=Date.now()),E(2,T)})]);let t=setInterval(()=>{if(!messageWindow.isOpen())return clearInterval(t);E(2,T),E(1,$),E(3,w),E(4,b)},1e3),a=setInterval(()=>{if(!messageWindow.isOpen())return clearInterval(a);J(),P().then(v=>{v&&(T=Date.now()),E(2,T)})},5e3),i=setInterval(()=>{if(!messageWindow.isOpen())return clearInterval(i);z(),G()},3e4)}n?(document.getElementById("user-icon")?.addEventListener("click",t=>f(userWindow,t.currentTarget)),document.getElementById("message-icon")?.addEventListener("click",t=>f(messageWindow,t.currentTarget)),document.getElementById("settings-icon")?.addEventListener("click",t=>f(settingsWindow,t.currentTarget))):document.getElementById("login-btn")?.addEventListener("click",()=>{f(loginWindow),setTimeout(()=>{document.getElementById("login-form")?.addEventListener("submit",t=>{t.preventDefault();try{te(document.getElementById("email-input").value),window.location.reload()}catch(a){let i=document.getElementById("login-error");i&&(i.textContent=a.message,i.style.display="block")}})},100)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ie):ie();})();
//# sourceMappingURL=dex.4fd35687.js.map
