(()=>{function Q(){console.log("Applying base styles dynamically (e.g., for background animation or theme toggles).")}function Z(n=!1){let r=`
        <div class="nav-left">
            <img src="/static/meta/favicon.svg" alt="Easter Company Favicon" class="navbar-favicon">
            <i class='bx bx-microphone' id="navbar-microphone"></i>
        </div>
        <div class="nav-right">
            ${n?`
            <i id="message-icon" class='bx bxs-message-dots'></i>
            <i id="user-icon" class='bx bx-user'></i>
            <i id="settings-icon" class='bx bx-cog'></i>
        `:`
            <button id="login-btn" class="login-btn">LOGIN</button>
        `}
        </div>
    `,y=document.createElement("nav");y.innerHTML=r,document.body.prepend(y)}function ee(){let n=`
        <div class="socials-section">
            <a href="https://facebook.com/eastercompany" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><i class="bx bxl-facebook-square"></i></a>
            <a href="https://linkedin.com/company/72223947" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="bx bxl-linkedin"></i></a>
            <a href="https://instagram.com/eastercompany" aria-label="Instagram" target="_blank" rel="noopener noreferrer"><i class="bx bxl-instagram-alt"></i></a>
            <a href="https://x.com/eastercompany" aria-label="X" target="_blank" rel="noopener noreferrer"><i class="bx bxl-twitter"></i></a>
            <a href="https://github.com/eastercompany" aria-label="GitHub" target="_blank" rel="noopener noreferrer"><i class="bx bxl-github"></i></a>
            <a href="https://youtube.com/@eastercompany" aria-label="YouTube" target="_blank" rel="noopener noreferrer"><i class="bx bxl-youtube"></i></a>
        </div>
    `,l=document.createElement("footer");l.innerHTML=n,document.body.appendChild(l)}var te="easter_user_email";function ne(){return localStorage.getItem(te)!==null}function se(n){if(!n||!n.includes("@"))throw new Error("Invalid email address");if(!n.trim().toLowerCase().endsWith("@easter.company"))throw new Error("Access denied. Please check your credentials.");localStorage.setItem(te,n.trim())}var le="easter_theme",I={AUTO:"auto",DEFAULT:"default",ANIMATED:"animated"};function de(){return localStorage.getItem(le)||I.AUTO}function ue(){let n=window.innerWidth,l=window.innerHeight,r=window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width;return n>1920&&l>1080?I.ANIMATED:(n===1920&&l===1080&&r||n<=1920||l<=1080,I.DEFAULT)}function ie(n,l=!1){let r=document.body,y=n===I.AUTO?ue():n;if(l||(r.classList.add("theme-transitioning"),setTimeout(()=>{r.classList.remove("theme-transitioning")},300)),Object.values(I).forEach(v=>{r.classList.remove(`theme-${v}`)}),r.classList.add(`theme-${n}`),y===I.ANIMATED){if(!document.querySelector(".background")){let v=document.createElement("div");v.className="background",document.body.prepend(v)}}else{let v=document.querySelector(".background");v&&(l?v.remove():(v.style.animation="fadeOutBackground 0.4s ease forwards",setTimeout(()=>{v.remove()},400)))}}function ae(){let n=de();if(ie(n,!0),n===I.AUTO){let l;window.addEventListener("resize",()=>{clearTimeout(l),l=setTimeout(()=>{ie(I.AUTO)},300)})}}function j(n,l,r=null){let v={config:"bx-cog",error:"bx-error-circle",empty:"bx-info-circle",offline:"bx-wifi-off"}[n]||"bx-info-circle",g=r?`<p class="placeholder-action">${r}</p>`:"";return`
        <div class="tab-placeholder">
            <i class='bx ${v} placeholder-icon'></i>
            <p class="placeholder-message">${l}</p>
            ${g}
        </div>
    `}async function R(){let n=document.getElementById("logs-container");if(!n)return!1;n.classList.remove("placeholder-active");let l=localStorage.getItem("service_map");if(!l)return n.classList.add("placeholder-active"),n.innerHTML=j("config","No service map configured.","Please upload your service-map.json in Settings to enable log monitoring."),!1;let r;try{r=JSON.parse(l)}catch(x){return console.error("Error parsing service_map from localStorage:",x),n.classList.add("placeholder-active"),n.innerHTML=j("error","Invalid service map data.","Please re-upload a valid service-map.json file in Settings."),!1}let y=null;if(r&&typeof r.services=="object"){let x=["cs","be","th"];for(let T of x)if(Array.isArray(r.services[T])){let M=r.services[T].find($=>$.short_name==="event"||$.id==="event"||$.id==="dex-event-service");if(M){y=M;break}}}if(!y)return n.classList.add("placeholder-active"),n.innerHTML=j("error","Event service not found in service map.","Please ensure dex-event-service is configured in your service-map.json."),!1;let g=`http://${y.domain==="0.0.0.0"?"localhost":y.domain}:${y.port}/logs`;try{let x=await fetch(g);if(!x.ok)return n.classList.add("placeholder-active"),n.innerHTML=j("offline","Event service is offline.","Please ensure the event service is running."),!1;let T=await x.json();if(!T||T.length===0)return n.classList.add("placeholder-active"),n.innerHTML=j("empty","No logs found.","Service logs will appear here when available."),!1;let M=["local-ollama-0","local-cache-0","cloud-cache-0","cloud-cache-1"],$=T.filter(E=>!M.includes(E.id));$.forEach(E=>{E.logs.reverse()}),$.reverse();let z=$.map(E=>{let W=E.logs.join(`
`);return`
                <div class="log-report">
                    <div class="log-report-header">
                        <h3>${E.id}</h3>
                        <button class="copy-logs-btn" data-logs="${escape(W)}">
                            <i class="bx bx-copy"></i>
                        </button>
                    </div>
                    <pre class="log-content">${W}</pre>
                </div>
            `}).join("");return n.innerHTML=z,document.querySelectorAll(".copy-logs-btn").forEach(E=>{E.addEventListener("click",()=>{let W=unescape(E.dataset.logs);navigator.clipboard.writeText(W).then(()=>{let C=E.querySelector("i");C.classList.remove("bx-copy"),C.classList.add("bx-check"),setTimeout(()=>{C.classList.remove("bx-check"),C.classList.add("bx-copy")},2e3)})})}),!0}catch(x){return console.error("Error fetching logs:",x),n.classList.add("placeholder-active"),n.innerHTML=j("offline","Failed to load logs.","The event service may be offline, unreachable, or blocked by a browser extension (e.g., ad blocker)."),!1}}function oe(){console.log("Welcome to Easter Company."),ae(),Q();let n=ne();Z(n),ee();let l=document.querySelector("footer"),r=null;function y(){r=null,l?.classList.remove("hide"),document.querySelectorAll(".nav-right i").forEach(t=>t.classList.remove("active","inactive"))}function v(t,a=null){let i=r&&r.id===t.id;r&&r.close(!i),i?r=null:setTimeout(()=>{t.open(),r=t,document.querySelectorAll(".nav-right i").forEach(u=>{let p=u===a;u.classList.toggle("active",p),u.classList.toggle("inactive",!p&&a)}),l?.classList.add("hide")},r?220:0)}function g(t,a,i=null){let p={config:"bx-cog",error:"bx-error-circle",empty:"bx-info-circle",offline:"bx-wifi-off"}[t]||"bx-info-circle",f=i?`<p class="placeholder-action">${i}</p>`:"";return`<div class="tab-placeholder"><i class='bx ${p} placeholder-icon'></i><p class="placeholder-message">${a}</p>${f}</div>`}let x=null,T=null,M=null,$=null,z=()=>localStorage.getItem("service_map")?'<div id="services-widgets" class="system-monitor-widgets"><p>Loading services...</p></div>':g("config","No service map configured.","Upload service-map.json in Settings."),E=()=>localStorage.getItem("service_map")?'<div id="models-widgets" class="system-monitor-widgets"><p>Loading models...</p></div>':g("config","No service map configured.","Upload service-map.json in Settings."),W=()=>'<div id="events-timeline" class="events-timeline"><p>Loading events...</p></div>';async function C(){if(!localStorage.getItem("service_map"))return null;try{let a=(JSON.parse(localStorage.getItem("service_map")).services?.cs||[]).find(f=>f.id==="dex-event-service");if(!a)return null;let u=`http://${a.domain==="0.0.0.0"?"localhost":a.domain}:${a.port}/system_monitor_metrics`,p=await fetch(u);if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);return await p.json()}catch(t){return console.error("Error fetching system data:",t),null}}async function G(){let t=document.getElementById("services-widgets");if(!t)return;let a=await C();if(!a||!a.services){t.innerHTML=g("offline","Failed to load system metrics.","The event service may be offline or unreachable.");return}x=Date.now(),S(4,x);let i=a.services||[];Array.from(t.children).forEach(e=>{e.classList.contains("service-widget")||e.remove()});function u(e){return!e||e==="N/A"||e==="unknown"||e.trim()===""?"-":e}function p(e){if(!e||e==="N/A"||e==="unknown")return"-";let s=e.match(/^(\d+\.\d+\.\d+)/);return s?s[0]:e.split(".").slice(0,3).join(".")||"-"}function f(e){return!e||e.length<=28?e:e.substring(0,28)+"..."}function h(e){if(!e||!e.includes("%"))return"#666";let s=parseFloat(e);return s<30?"#00ff00":s<60?"#88ff00":s<80?"#ffaa00":"#ff0000"}function m(e){if(!e||e==="N/A"||e==="unknown")return"-";let s=e.match(/(?:(\d+)d)?(?:(\d+)h)?(?:(\d+)m)?(?:([\d.]+)s)?/);if(!s)return"-";let L=parseInt(s[1])||0,c=parseInt(s[2])||0,o=parseInt(s[3])||0,d=parseFloat(s[4])||0,w=L*86400+c*3600+o*60+d,D=Math.floor(w/86400);if(D>0)return`${D}d`;let N=Math.floor(w/3600);if(N>0)return`${N}h`;let H=Math.floor(w/60);return H>0?`${H}m`:`${Math.floor(w)}s`}function b(e){let s=e.status==="online",L=s?"service-widget-online":"service-widget-offline",c=s?"bx-check-circle":"bx-x-circle",o=s?"OK":"BAD",d=e.version?p(e.version.str):"-",w=u(e.cpu),D=u(e.memory),N=h(w),H=h(D),F=m(e.uptime),U="";return s?U=`<div class="service-widget-info"><span class="info-label">Version:</span><span class="info-value metric-version-monospace">${d}</span></div><div class="service-widget-footer"><div class="service-widget-item"><i class="bx bx-time-five"></i><span>${F}</span></div><div class="service-widget-item"><i class="bx bxs-microchip" style="color: ${N};"></i><span style="color: ${N};">${w}</span></div><div class="service-widget-item"><i class="bx bxs-chip" style="color: ${H};"></i><span style="color: ${H};">${D}</span></div></div>`:U='<div class="service-widget-footer offline"><span>OFFLINE</span></div>',`<div class="service-widget ${L}" data-service-id="${e.id}"><div class="service-widget-header"><i class="bx ${c}"></i><h3>${e.short_name||e.id}</h3><span class="service-widget-status">${o}</span></div><div class="service-widget-body"><div class="service-widget-info"><span class="info-label">Address:</span><span class="info-value">${f(e.domain&&e.port?`${e.domain}:${e.port}`:"")}</span></div>${U}</div></div>`}let k=new Map(Array.from(t.querySelectorAll(".service-widget")).map(e=>[e.dataset.serviceId,e])),A=new Set(i.map(e=>e.id));for(let[e,s]of k)A.has(e)||s.remove();i.forEach(e=>{let s=b(e),L=k.get(e.id);L?L.outerHTML!==s&&(L.outerHTML=s):t.insertAdjacentHTML("beforeend",s)})}async function J(){let t=document.getElementById("models-widgets");if(!t)return;let a=await C();if(!a){t.innerHTML=g("offline","Failed to load model status.");return}$=Date.now(),S(3,$);let i=a.models||[],u=a.whisper;Array.from(t.children).forEach(m=>{m.classList.contains("service-widget")||m.remove()});function p(m){let b=m.status==="Ready";return`
                <div class="service-widget ${b?"service-widget-online":"service-widget-offline"}" data-whisper-widget>
                    <div class="service-widget-header">
                        <i class="bx bxs-microphone-alt"></i>
                        <h3>Whisper</h3>
                        <span class="service-widget-status">${b?"READY":"NOT FOUND"}</span>
                    </div>
                    <div class="service-widget-body">
                        <div class="service-widget-info">
                            <span class="info-label">Status:</span>
                            <span class="info-value">${m.status}</span>
                        </div>
                        <div class="service-widget-info">
                            <span class="info-label">Model:</span>
                            <span class="info-value">large-v3-turbo</span>
                        </div>
                    </div>
                </div>`}function f(m){let b=m.status==="Downloaded",k=b?"service-widget-online":"service-widget-offline",A=b?"OK":"MISSING",e=b&&m.size>0?`${(m.size/1e9).toFixed(2)} GB`:"-",s=m.name;return m.type==="custom"&&s.endsWith(":latest")&&(s=s.replace(":latest","")),`<div class="service-widget ${k}" data-model-name="${m.name}"><div class="service-widget-header"><i class="bx ${b?"bx-check-circle":"bx-x-circle"}"></i><h3>${s}</h3><span class="service-widget-status">${A}</span></div><div class="service-widget-body"><div class="service-widget-info"><span class="info-label">Type:</span><span class="info-value">${m.type}</span></div><div class="service-widget-info"><span class="info-label">Size:</span><span class="info-value">${e}</span></div></div></div>`}let h="";if(u&&(h+=p(u)),h+=i.map(f).join(""),!h){t.innerHTML=g("empty","No models found.");return}t.innerHTML!==h&&(t.innerHTML=h)}async function K(){let t=document.getElementById("events-timeline");if(!t)return;let a=localStorage.getItem("service_map");if(!a){t.innerHTML=g("config","No service map configured.","Upload service-map.json in Settings.");return}let i=null;try{i=(JSON.parse(a).services?.cs||[]).find(h=>h.id==="dex-event-service")}catch{t.innerHTML=g("error","Invalid service map data.");return}if(!i){t.innerHTML=g("error","Event service not found in service map.");return}let p=`http://${i.domain==="0.0.0.0"?"localhost":i.domain}:${i.port}/events?ml=50&format=json`;try{let f=new Set(Array.from(t.querySelectorAll(".event-item.expanded")).map(c=>c.dataset.eventId).filter(c=>c)),h=await fetch(p);if(!h.ok)throw new Error("Service is offline or unreachable.");let b=(await h.json()).events||[];if(b.length===0){t.innerHTML=g("empty","No events found.");return}let k=c=>{let o=c.event;if(typeof o=="string")try{o=JSON.parse(o)}catch{return null}let d=o.type,w=d==="engagement.decision",D=w?"event-border-blue":"event-border-grey",N=w?"cursor-pointer":"",H=f.has(c.id),F=H?"expanded":"",U=H?"display: block;":"display: none;",V=new Date(c.timestamp*1e3),re=V.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit",second:"2-digit"}),ce=V.toLocaleDateString(navigator.language,{month:"short",day:"numeric"}),q=`${d}`;d==="message_received"||d==="messaging.user.sent_message"?q=`${o.user_name||o.user} in ${o.channel_name||o.channel}: ${o.content||o.message}`:d==="engagement.decision"?q=`Engagement Decision: ${o.decision} (${o.reason})`:d==="bot_response"?q=`Bot Responded: ${o.response}`:(d==="voice_transcribed"||d==="messaging.user.transcribed")&&(q=`${o.user_name||o.user_id} said: ${o.transcription}`);let Y="";w&&(Y=`
                        <div class="event-details" style="${U}">
                            <div class="event-details-header">
                                <h4>Event Details</h4>
                                <i class="bx bx-x close-details-btn"></i>
                            </div>
                            <div class="event-detail-row">
                                <span class="detail-label">Engagement Model:</span>
                                <span class="detail-value">${o.engagement_model||"N/A"}</span>
                            </div>
                            <div class="event-detail-row">
                                <span class="detail-label">Response Model:</span>
                                <span class="detail-value">${o.response_model||"N/A"}</span>
                            </div>
                            <div class="event-detail-block">
                                <span class="detail-label">Context History:</span>
                                <pre class="detail-pre">${o.context_history||"None"}</pre>
                            </div>
                            <div class="event-detail-block">
                                <span class="detail-label">Raw Engagement Output:</span>
                                <pre class="detail-pre">${o.engagement_raw||"None"}</pre>
                            </div>
                            <div class="event-detail-block">
                                <span class="detail-label">Raw Response Output:</span>
                                <pre class="detail-pre">${o.response_raw||"None"}</pre>
                            </div>
                        </div>
                    `);let _=document.createElement("div");if(_.className=`event-item ${D} ${N} ${F}`,_.dataset.eventId=c.id,_.onclick=function(B){if(!w)return;this.classList.toggle("expanded");let O=this.querySelector(".event-details");O&&(O.style.display=O.style.display==="none"?"block":"none")},_.innerHTML=`
                    <div class="event-time">
                        <span class="event-time-main">${re}</span>
                        <span class="event-date">${ce}</span>
                    </div>
                    <div class="event-content">
                        <div class="event-service">${c.service}</div>
                        <div class="event-message">${q}</div>
                        ${Y}
                    </div>
                `,w){let B=_.querySelector(".close-details-btn");B&&B.addEventListener("click",O=>{O.stopPropagation();let P=O.target.closest(".event-item");if(P){P.classList.remove("expanded");let X=P.querySelector(".event-details");X&&(X.style.display="none")}})}return _},A=Array.from(t.children),e=new Map(A.map(c=>[c.dataset.eventId,c])),s=new Set(b.map(c=>c.id));A.forEach(c=>{c.dataset.eventId&&!s.has(c.dataset.eventId)&&c.remove()});let L=null;b.forEach((c,o)=>{let d=e.get(c.id);!d&&(d=k(c),!d)||(o===0?t.firstElementChild!==d&&t.prepend(d):L&&L.nextElementSibling!==d&&L.after(d),L=d)}),T=Date.now(),S(1,T)}catch(f){console.error("Error fetching events:",f),t.children.length===0&&(t.innerHTML=g("offline","Failed to load events.","The event service may be offline or unreachable."))}}function S(t,a){let i=document.querySelector(`.tab[data-tab-index="${t}"] .tab-subtitle`);if(!i)return;if(!a){i.textContent="Last updated: never";return}let p=(Date.now()-a)/1e3,f;if(p<30)f=`${Math.floor(p)}s ago`;else{i.textContent="Last updated: never";return}i.textContent=`Last updated: ${f}`}async function ve(){await Promise.all([G(),J(),K(),R().then(u=>{u&&(M=Date.now()),S(2,M)})]);let t=setInterval(()=>{if(!messageWindow.isOpen())return clearInterval(t);S(2,M),S(1,T),S(3,$),S(4,x)},1e3),a=setInterval(()=>{if(!messageWindow.isOpen())return clearInterval(a);K(),R().then(u=>{u&&(M=Date.now()),S(2,M)})},5e3),i=setInterval(()=>{if(!messageWindow.isOpen())return clearInterval(i);G(),J()},3e4)}n?(document.getElementById("user-icon")?.addEventListener("click",t=>v(userWindow,t.currentTarget)),document.getElementById("message-icon")?.addEventListener("click",t=>v(messageWindow,t.currentTarget)),document.getElementById("settings-icon")?.addEventListener("click",t=>v(settingsWindow,t.currentTarget))):document.getElementById("login-btn")?.addEventListener("click",()=>{v(loginWindow),setTimeout(()=>{document.getElementById("login-form")?.addEventListener("submit",t=>{t.preventDefault();try{se(document.getElementById("email-input").value),window.location.reload()}catch(a){let i=document.getElementById("login-error");i&&(i.textContent=a.message,i.style.display="block")}})},100)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",oe):oe();})();
//# sourceMappingURL=dex.807ea0a8.js.map
